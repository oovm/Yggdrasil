grammar Bootstrap {

}

entry class Root {
    Statement*
}

union Statement {
    | ClassStatements
    | UnionStatements
}

// === class === -----------------------------------------------------------------------------------------------------
class ClassStatements {
    ^KW_CLASS Identifier ClassBlock
}
class ClassBlock {
    '{' Expression* '}'
}
// === union === -----------------------------------------------------------------------------------------------------
class UnionStatements {
    ^KW_UNION Identifier
}
class UnionBlock {
    '{' UnionBranch* '}'
}
class UnionBranch {
    Expression
}
// === group === -----------------------------------------------------------------------------------------------------
class GroupStatements {
    ^KW_GROUP Identifier
}
// === expression === -----------------------------------------------------------------------------------------------------
class Expression {
    Term (Infix Term)*
}
class Term {
    Prefix* Atomic Suffix*
}
union Infix {
    | '~' #Soft
}
union Prefix {
    | '!' #Negative
    | '&' #Positive
    | '^' #Remark
}
union Suffix {
    | '?' #Negative
    | '*' #Positive
    | '+' #Remark
}
// === atoms === -----------------------------------------------------------------------------------------------------
union Atomic {
    | Identifier
    | Boolean
}
// === identifier === --------------------------------------------------------------------------------------------------
class NamepathFree -> Namepath {
    Identifier (('.' | '::') Identifier)*
}
class Namepath {
    Identifier ('::' Identifier)*
}
class Identifier {
    /[_\p{XID_start}]\p{XID_continue}*/
}
union Boolean {
    | 'true'  #True
    | 'false' #False
}
// === keywords === ----------------------------------------------------------------------------------------------------
@style(keyword)
token {
    KW_CLASS: 'class'
    KW_UNION: 'union'
    KW_GROUP: 'group'
}
// === ignores === -----------------------------------------------------------------------------------------------------
ignore class WhiteSpace {
    /\p{White_Space}+/
}
@style(comment)
ignore union Comment {
    | /\/\/[^\n\r]*/
    | /#[^\n\r]*/
}
